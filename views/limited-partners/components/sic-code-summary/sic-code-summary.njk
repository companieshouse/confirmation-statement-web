{% extends "../../layouts/layout.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/input/macro.njk" import govukInput %}

{% set errors = pageProperties.errors %}

{% set title = i18n.SICCSPageTitle %}

{% set summaryDetail %}
  <p class="govuk-body">{{ i18n.SICCSWhatIsDetailExpanderParagraph1 }}</p>
  <p class="govuk-body">{{ i18n.SICCSWhatIsDetailExpanderParagraph2 }}</p>
  <p class="govuk-body">{{ i18n.SICCSWhatIsDetailExpanderParagraph3 }}</p>
  <p class="govuk-body">
    {{ i18n.SICCSWhatIsDetailExpanderParagraph4Start }}
    <a class="govuk-link" href="https://resources.companieshouse.gov.uk/sic/">
      {{ i18n.SICCSWhatIsDetailExpanderParagraph4Link }}
    </a>
    {{ i18n.SICCSWhatIsDetailExpanderParagraph4End }}
  </p>
{% endset %}

{% block content %}
  <style>
    button.govuk-link {
      background: none;
      border: none;
      padding: 0;
      font: inherit;
      color: #1d70b8;
      text-decoration: underline;
      cursor: pointer;
    }
    .autocomplete__menu {
      z-index: 1000;
      position: absolute;
    }
  </style>
    <div class="govuk-grid-row">
        <div class="govuk-width-container">
            <div class="govuk-grid-column-two-thirds">

                <h1 class="govuk-heading-xl">
                    <span class="govuk-caption-l">ACME LIMITED PARTNERSHIP (SL012345)</span>
                    {{ i18n.SICCSPageTitle }}
                </h1>

                <p class="govuk-body">
                    {{ i18n.SICCSTableHeader }}
                </p>    

                <div class="govuk-summary-list" role="list">
                    {% for sic in sicCodes %}
                        <div class="govuk-summary-list__row">
                        <div class="govuk-summary-list__key">{{ sic.code }}</div>
                        <div class="govuk-summary-list__value">{{ sic.description }}</div>
                        <div class="govuk-summary-list__actions">
                            <form action="{{ urls.LP_SIC_CODE_SUMMARY_PATH }}/{{ sic.code }}/remove" method="POST">
                            {% include "../../partials/csrf-token.njk" %}
                                <button type="submit" class="govuk-link">{{ i18n.SICCSTableRemoveButton }}</button>
                            </form>
                        </div>
                        </div>
                    {% endfor %}
                </div>
                
                <form action="{{ urls.LP_SIC_CODE_SUMMARY_PATH }}/add" method="POST">
                {% include "../../partials/csrf-token.njk" %}
                <div class="govuk-inset-text">
                    <div class="govuk-form-group govuk-!-margin-bottom-6">
                        <label class="govuk-label govuk-label--m" for="sic-code-input">
                          {{ i18n.SICCSAddSICInsetTitle }}
                        </label>
                        <div id="sic-hint" class="govuk-hint">
                          {{ i18n.SICCSAddSICInsetInstructions }}
                        </div>

                        <div id="sic-code-autocomplete"></div>
                        <input type="hidden" name="code" id="hidden-sic-code" />
                    </div>    
                    {{ govukButton({
                      text: i18n.SICCSAddSICAddCodeButton,
                      classes: "govuk-button--secondary", 
                      attributes: {
                        id: "add-sic-code-button",
                        type: "submit",
                        disabled: "disabled"
                      }
                    }) }}
                </div>
                </form>

                {{ govukDetails({
                    summaryText: i18n.SICCSWhatIsDetailExpanderTitle,
                    html: summaryDetail
                }) }}

                <form action="{{ LP_SIC_CODE_SUMMARY_PATH }}" method="POST">
                {% include "../../partials/csrf-token.njk" %}
                    {{ govukButton({
                        id: 'continue',
                        text: i18n.SICCSSaveContinueButton,
                        type: "submit"
                    }) }}
                </form>    
            </div>
        </div>
    </div>

<script>
  window.searchSicCodes = {{ searchSicCodes | dump | safe }};
</script>
<link rel="stylesheet" href="{{assetPath}}/stylesheets/accessible-autocomplete/autocomplete.min.css" />
<script type="text/javascript" src="{{assetPath}}/javascripts/app/accessible-autocomplete.min.js"></script>
{% include "../../../includes/scripts/lp.sic.code.autocomplete.js" %}
{% endblock %}